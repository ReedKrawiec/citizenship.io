from imports.login_functions import generate_salt, hash_pass, ver_pass_hash

SALT = b'\x85\x9e\xac\x15\x7f\xb0o\xf8\xac\xfb\xce\x92\x9ceBv\x9b>\x92Xa\x8a\xfe6fm\x1f\x18\x01\xff\x14\xf9'

password = "test_password"

hash_value = b'&fq\xa3\x03\n\xa7\x8d\xf3\xf0\x0f\xe2L\xb7\xcf\xf3\xc1Fb\x05\x1dk\xbd(\xefw6r\x89\x90d\x01\xd7`\xdd6\xb8\xb3m9\xb2\t`R\\+\xc8F\xed\xd2/\xec\x9e\xa3\xb2\xc2\xc0\x88%\x1e}x<\xb7\x02\x82\x81t\xe8\xb5\x82\x92\xe1>\xe9\x12I\x886g+#\xe7\xba\xbd\xb0\x87\xe3/\x91\xd0!\xe4\x15\x1c\xc1\xdee\x0e\xc4j\x9cNQK\x143\xcfN\xbe}\xe8#\xc9_\xb7\xcaN\x8d\xa8\xe1\x0c\xcd\x10\x1bu\x98%'

def test_hash():
    assert hash_pass(password,SALT)==hash_value
    assert ver_pass_hash(hash_value,SALT,password)==True
    assert ver_pass_hash(hash_value,generate_salt(),password)==False
    assert ver_pass_hash(hash_value,SALT,"wrong_pass")==False

if __name__ == "__main__": 
    test_hash()
    print("Everything passed")
